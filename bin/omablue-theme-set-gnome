#!/bin/bash

# Omablue GNOME/GTK Theme Setter - Secureblue Edition
# Gestisce l'estetica delle app GTK e Flatpak

THEME_CURRENT="$HOME/.config/omablue/current/theme"

# 1. Gestione Dark/Light Mode (fondamentale per Flatpak)
if [[ -f "$THEME_CURRENT/light.mode" ]]; then
    # Imposta la preferenza chiara
    gsettings set org.gnome.desktop.interface color-scheme "prefer-light"
    gsettings set org.gnome.desktop.interface gtk-theme "Adwaita"
else
    # Default: preferenza scura (standard secureblue)
    gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"
    gsettings set org.gnome.desktop.interface gtk-theme "Adwaita-dark"
fi

# 2. Icone (Catppuccin o Yaru-Blue come fallback)
GNOME_ICONS_THEME="$THEME_CURRENT/icons.theme"
if [[ -f "$GNOME_ICONS_THEME" ]]; then
    ICON_NAME=$(cat "$GNOME_ICONS_THEME")
    gsettings set org.gnome.desktop.interface icon-theme "$ICON_NAME"
else
    # Fallback sicuro e coerente con Fedora
    gsettings set org.gnome.desktop.interface icon-theme "Adwaita"
fi

# 3. Font (Coerenza con Ghostty e Sway)
# Utilizziamo JetBrainsMono se disponibile
gsettings set org.gnome.desktop.interface font-name "JetBrainsMono Nerd Font 10"
gsettings set org.gnome.desktop.interface document-font-name "Sans 10"
gsettings set org.gnome.desktop.interface monospace-font-name "JetBrainsMono Nerd Font 10"

echo "âœ… GNOME/GTK Settings updated for Omablue"
