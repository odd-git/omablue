#!/bin/bash

# Omablue GNOME/GTK Theme Setter - Secureblue Edition
# Manages the aesthetics for GTK and Flatpak applications

THEME_CURRENT="$HOME/.config/omablue/current/theme"

# 1. Dark/Light Mode Management (Essential for Flatpak compatibility)
if [[ -f "$THEME_CURRENT/light.mode" ]]; then
  # Set light mode preference
  gsettings set org.gnome.desktop.interface color-scheme "prefer-light"
  gsettings set org.gnome.desktop.interface gtk-theme "Adwaita"
else
  # Default: dark mode preference (Standard for Secureblue)
  gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"
  gsettings set org.gnome.desktop.interface gtk-theme "Adwaita-dark"
fi

# 2. Icons (Catppuccin or Yaru-Blue as fallback)
GNOME_ICONS_THEME="$THEME_CURRENT/icons.theme"
if [[ -f "$GNOME_ICONS_THEME" ]]; then
  ICON_NAME=$(cat "$GNOME_ICONS_THEME")
  gsettings set org.gnome.desktop.interface icon-theme "$ICON_NAME"
else
  # Secure and consistent fallback for Fedora-based systems
  gsettings set org.gnome.desktop.interface icon-theme "Adwaita"
fi

# 3. Fonts (Maintaining consistency with Ghostty and Sway)
# Using JetBrainsMono as the primary Nerd Font
gsettings set org.gnome.desktop.interface font-name "JetBrainsMono Nerd Font 10"
gsettings set org.gnome.desktop.interface document-font-name "Sans 10"
gsettings set org.gnome.desktop.interface monospace-font-name "JetBrainsMono Nerd Font 10"

echo "âœ… GNOME/GTK Settings updated for Omablue"
